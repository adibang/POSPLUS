<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POSPLUS</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        /* ==================== RESET & BASE STYLES ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, sans-serif;
            background: #FFFFFF;
            min-height: 100vh;
            color: #333333;
        }
        /* ==================== LOGIN OVERLAY ==================== */
        #login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f5f5f5;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-family: sans-serif;
            transition: opacity 0.5s;
        }
        .login-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            width: 300px;
            text-align: center;
        }
        .login-container h2 {
            color: #006B54;
            margin-bottom: 20px;
        }
        .login-container input {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
        }
        .login-container button {
            width: 100%;
            padding: 12px;
            background: #006B54;
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
        }
        .login-container .error-message {
            color: red;
            margin-top: 15px;
            display: none;
        }
        .login-container .hint {
            margin-top: 20px;
            font-size: 0.8rem;
            color: #999;
        }
        /* ==================== DRAWER SIDEBAR ==================== */
        .drawer-toggle {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #006B54;
        }
        .drawer-toggle svg {
            width: 24px;
            height: 24px;
        }
        .sidebar {
            position: fixed;
            left: -220px;
            top: 0;
            width: 220px;
            height: 100vh;
            background: #ffffff;
            box-shadow: 2px 0 8px rgba(0,0,0,0.1);
            z-index: 300;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            gap: 5px;
            overflow-y: auto;
            transition: left 0.3s ease;
        }
        .sidebar.open {
            left: 0;
        }
        .menu-group {
            margin-bottom: 5px;
        }
        .menu-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background-color: #f5f5f5;
            cursor: pointer;
            border-radius: 8px;
            margin: 0 10px 5px;
            font-weight: 700;
            color: #006B54;
            transition: background 0.2s;
        }
        .menu-header:hover {
            background-color: #e0e0e0;
        }
        .menu-header .arrow {
            transition: transform 0.2s;
        }
        .menu-header.open .arrow {
            transform: rotate(90deg);
        }
        .sub-menu {
            display: none;
            margin-bottom: 10px;
        }
        .sub-menu button {
            margin: 5px 10px;
            padding: 12px 16px;
            border: 1px solid #006B54;
            border-radius: 15px;
            background: white;
            color: #006B54;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
            width: calc(100% - 20px);
        }
        .sub-menu button:hover {
            background: #f0f9f6;
        }
        .sub-menu button svg {
            width: 18px;
            height: 18px;
        }
        .drawer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 250;
            display: none;
        }
        .drawer-overlay.show {
            display: block;
        }
        body.drawer-open .app-header,
        body.drawer-open .main-content {
            margin-left: 0;
        }
        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }
            .sidebar button span {
                display: none;
            }
            .sidebar.open {
                width: 220px;
            }
            .sidebar.open button span {
                display: inline;
            }
        }
        /* ==================== HEADER ==================== */
        .app-header {
            background: #FFFFFF;
            color: #006B54;
            padding: 16px 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .app-title {
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #006B54;
        }
        .header-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .header-actions button {
            background: #FFFFFF;
            color: #006B54;
            padding: 8px 12px;
            border-radius: 15px;
            border: 1px solid #006B54;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .header-actions button:hover {
            background: #006B54;
            color: white;
        }
        /* ==================== MAIN CONTENT ==================== */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            text-align: center;
            color: #666;
        }
        .main-content .placeholder-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            color: #006B54;
            opacity: 0.5;
        }
        .main-content h2 {
            font-weight: 400;
            margin-bottom: 10px;
            color: #333;
        }
        .main-content p {
            color: #999;
        }
        /* ==================== HALAMAN TRANSAKSI (PRODUK) ==================== */
        #transaksi-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: none;
        }
        .transaksi-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .transaksi-header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .transaksi-header-left h2 {
            color: #006B54;
            font-size: 1.5rem;
            margin: 0;
        }
        .back-button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #006B54;
            border-radius: 15px;
            transition: background 0.2s;
        }
        .back-button:hover {
            background: #f0f9f6;
        }
        .back-button svg {
            width: 24px;
            height: 24px;
            stroke-width: 2;
        }
        .transaksi-header-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .view-toggle {
            display: flex;
            gap: 5px;
        }
        .view-toggle button {
            width: 40px;
            height: 40px;
            border-radius: 15px;
            border: 1px solid #006B54;
            background: white;
            color: #006B54;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            min-height: auto;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .view-toggle button.active {
            background: #006B54;
            color: white;
        }
        .view-toggle button svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }
        /* ==================== HALAMAN CART ==================== */
        #cart-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: none;
        }
        .cart-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .cart-header h2 {
            color: #006B54;
            font-size: 1.5rem;
            margin: 0;
        }
        .cart-content {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .cart-items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .cart-items-table th {
            text-align: left;
            padding: 12px;
            background: #f5f5f5;
            color: #333;
        }
        .cart-items-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        .cart-total {
            text-align: right;
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 600;
        }
        @media (max-width: 768px) {
            .cart-items-table th,
            .cart-items-table td {
                font-size: 0.8rem;
                padding: 6px;
            }
            .cart-total {
                font-size: 1.1rem;
            }
        }
        .cart-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        /* ==================== HALAMAN PEMBAYARAN (MODIFIKASI) ==================== */
        #payment-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: none;
        }
        .payment-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .payment-header h2 {
            color: #006B54;
            font-size: 1.5rem;
            margin: 0;
        }
        .payment-content {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .payment-summary {
            margin-bottom: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 15px;
        }
        .payment-summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .payment-summary-row.total {
            font-weight: 600;
            font-size: 1.3rem;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }
        .payment-methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .payment-method-item {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
        }
        .payment-method-item label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #006B54;
        }
        .payment-method-item input {
            width: 100%;
            padding: 10px;
            border: 1px solid #006B54;
            border-radius: 15px;
            font-size: 1rem;
            text-align: right;
        }
        #shortage-display {
            display: none;
            margin-bottom: 15px;
            padding: 10px;
            background: #fff3f3;
            border-radius: 10px;
            border: 1px solid #ff6b6b;
            color: #ff0000;
            font-weight: 600;
        }
        .change-amount {
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #006B54;
        }
        .payment-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        .printer-section {
            margin-top: 20px;
            border-top: 1px solid #ddd;
            padding-top: 15px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 15px;
        }
        .printer-status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .status-light {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: #ff4444;
            transition: background-color 0.3s;
        }
        .status-light.connected {
            background-color: #00C851;
        }
        #connect-printer-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #006B54;
            color: white;
            border: 1px solid #006B54;
        }
        #connect-printer-btn svg {
            width: 18px;
            height: 18px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }
        #print-receipt-btn {
            background: #006B54;
            color: white;
            border: 1px solid #006B54;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        #print-receipt-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }
        .modal-content {
            background: #FFFFFF;
            border-radius: 15px;
            width: 100%;
            max-width: 450px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.2s ease;
        }
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .modal-header {
            padding: 12px 20px;
            color: #006B54;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-bottom: 1px solid rgba(0, 107, 84, 0.1);
            position: relative;
            background: #FFFFFF;
        }
        .modal-title {
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #006B54;
        }
        .modal-body {
            padding: 20px;
            max-height: calc(90vh - 60px);
            overflow-y: auto;
            background: #FFFFFF;
        }
        input, textarea, select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #333333 !important;
            border-radius: 15px !important;
            font-size: 1rem;
            background: #FFFFFF !important;
            color: #333333 !important;
            transition: all 0.2s;
        }
        input:focus, textarea:focus, select:focus {
            border-color: #006B54 !important;
            outline: none !important;
            box-shadow: 0 0 0 3px rgba(0, 107, 84, 0.1) !important;
        }
        input::placeholder, textarea::placeholder {
            color: #999999 !important;
        }
        button {
            border-radius: 15px;
            padding: 12px 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
            min-height: 48px;
        }
        .form-button-primary {
            background: #006B54;
            color: white;
            border: 1px solid #006B54;
        }
        .form-button-primary:hover {
            background: #005a46;
        }
        .form-button-secondary {
            background: #d9d9d9;
            color: #333333;
            border: 1px solid #d9d9d9;
        }
        .form-button-secondary:hover {
            background: #cccccc;
        }
        .action-btn {
            width: 48px;
            height: 48px;
            border-radius: 15px;
            border: 1px solid #006B54;
            background: white;
            color: #006B54;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            min-height: auto;
            position: relative;
        }
        .action-btn svg {
            width: 24px;
            height: 24px;
            stroke-width: 2;
        }
        .customer-badge {
            position: absolute;
            bottom: -2px;
            right: -2px;
            background: #006B54;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
            font-weight: bold;
            text-transform: uppercase;
        }
        .cart-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: #006B54;
            color: white;
            border-radius: 50%;
            min-width: 20px;
            height: 20px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
            font-weight: bold;
            padding: 0 4px;
        }
        .action-btn.delete-btn {
            border-color: #ff6b6b;
            color: #ff6b6b;
        }
        .action-btn.delete-btn:hover {
            background: #ff6b6b;
            color: white;
        }
        .action-btn.edit-btn:hover {
            background: #006B54;
            color: white;
        }
        #cart-items button {
            padding: 4px 8px;
            font-size: 0.8rem;
            min-height: 30px;
            background: #ff6b6b;
            color: white;
            border: none;
        }
        .icon {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 1.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
        }
        .icon-sm {
            width: 16px;
            height: 16px;
        }
        .icon-primary {
            color: #006B54;
        }
        .icon-white {
            color: white;
        }
        .icon-danger {
            color: #ff6b6b;
        }
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #006B54;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            display: none;
        }
        .error-state .icon {
            width: 60px;
            height: 60px;
            margin-bottom: 20px;
            color: #ff6b6b;
        }
        .retry-button {
            margin-top: 20px;
            padding: 12px 24px;
            background: #006B54;
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .audio-notification {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        .level-harga-container {
            border: 1px solid #d9d9d9;
            border-radius: 15px;
            padding: 15px;
            margin-top: 10px;
            background: #f9f9f9;
        }
        .level-harga-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        .level-harga-item input {
            flex: 1;
        }
        .level-number {
            font-weight: 600;
            min-width: 60px;
            color: #006B54;
        }
        .level-harga-remove {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 15px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
        }
        .btn-add-level {
            background: #006B54;
            color: white;
            border: none;
            border-radius: 15px;
            padding: 10px 16px;
            margin-top: 10px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }
        .conversions-section {
            margin-bottom: 15px;
        }
        #add-conversion-btn {
            width: 100%;
            padding: 12px;
            border: 2px dashed #006B54;
            border-radius: 15px;
            background: white;
            color: #006B54;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        #add-conversion-btn:hover {
            background: #f0f9f6;
        }
        .conversions-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .conversion-item {
            background: #f9f9f9;
            border: 1px solid #d9d9d9;
            border-radius: 15px;
            padding: 12px;
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .conversion-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: #006B54;
        }
        .conversion-item-details {
            font-size: 0.9rem;
            color: #333;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 4px;
        }
        .conversion-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }
        .conversion-edit-btn, .conversion-delete-btn {
            padding: 4px 8px;
            border: none;
            background: none;
            cursor: pointer;
            color: #666;
            min-height: auto;
            font-size: 0.9rem;
        }
        .conversion-edit-btn:hover {
            color: #006B54;
        }
        .conversion-delete-btn:hover {
            color: #ff6b6b;
        }
        #conversion-form-container {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            display: none;
        }
        #conversion-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .form-row {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .form-row label {
            font-weight: 500;
            font-size: 0.85rem;
            color: #333;
        }
        .form-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        .three-dots-menu {
            position: relative;
            display: inline-block;
        }
        .three-dots-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .three-dots-btn:hover {
            background: rgba(0,0,0,0.05);
        }
        .three-dots-dropdown {
            position: absolute;
            right: 0;
            top: 100%;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 10;
            min-width: 120px;
            display: none;
        }
        .three-dots-dropdown.show {
            display: block;
        }
        .three-dots-dropdown .dropdown-item {
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }
        .three-dots-dropdown .dropdown-item:hover {
            background: #f5f5f5;
        }
        .three-dots-dropdown .dropdown-item.edit {
            color: #006B54;
        }
        .three-dots-dropdown .dropdown-item.delete {
            color: #ff6b6b;
        }
        #cart-items td, #cart-items th {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        #cart-items th {
            text-align: left;
            background-color: #f5f5f5;
        }
        #product-container {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 15px;
            padding: 10px;
        }
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
            padding: 5px;
        }
        .product-card {
            border: 1px solid #006B54;
            border-radius: 15px;
            padding: 10px;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .product-card:hover {
            background: #f0f9f6;
        }
        .product-card .product-image svg {
            width: 60px;
            height: 60px;
            color: #006B54;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        .product-card .name {
            font-weight: 600;
            color: #006B54;
            font-size: 0.9rem;
            margin: 5px 0;
            line-height: 1.2;
            min-height: 2.4em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            width: 100%;
        }
        .product-card .price {
            font-size: 0.85rem;
            color: #333;
            font-weight: 500;
        }
        .product-card .stock {
            font-size: 0.75rem;
            color: #666;
            margin-bottom: 5px;
        }
        .product-card .qty-control {
            display: flex;
            gap: 4px;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-top: 5px;
        }
        .product-card .qty-control button {
            width: 28px;
            height: 28px;
            border-radius: 10px;
            border: 1px solid #006B54;
            background: white;
            color: #006B54;
            font-weight: bold;
            cursor: pointer;
            padding: 0;
            min-height: auto;
            font-size: 1.1rem;
            line-height: 1;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .product-card .qty-control input {
            width: 45px;
            text-align: center;
            padding: 4px;
            border-radius: 8px;
            border: 1px solid #006B54;
            font-size: 0.85rem;
        }
        .product-list-item {
            display: flex;
            flex-direction: column;
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        .product-list-item:hover {
            background: #f5f5f5;
        }
        .product-list-item .name {
            font-weight: 600;
            color: #006B54;
        }
        .product-list-item .price {
            font-size: 0.9rem;
            color: #333;
        }
        .product-list-item .stock {
            font-size: 0.8rem;
            color: #666;
            margin-top: 4px;
        }
        .product-list-item .qty-control {
            display: flex;
            justify-content: flex-end;
            gap: 4px;
            align-items: center;
            margin-top: 4px;
        }
        .product-list-item .qty-control button {
            width: 28px;
            height: 28px;
            border-radius: 10px;
            border: 1px solid #006B54;
            background: white;
            color: #006B54;
            font-weight: bold;
            cursor: pointer;
            padding: 0;
            min-height: auto;
            font-size: 1.1rem;
        }
        .product-list-item .qty-control input {
            width: 45px;
            text-align: center;
            padding: 4px;
            border-radius: 8px;
            border: 1px solid #006B54;
            font-size: 0.85rem;
        }
        #notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 20px;
            border-radius: 15px;
            display: none;
            color: white;
            background-color: #006B54;
            max-width: 90%;
            text-align: center;
            z-index: 1001;
            font-size: 14px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .floating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #006B54;
            color: white;
            border: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
            transition: transform 0.2s;
        }
        .floating-btn:hover {
            transform: scale(1.1);
        }
        .floating-btn svg {
            width: 30px;
            height: 30px;
        }
        .pending-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #dc3545;
            color: white;
            border-radius: 50%;
            min-width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
            font-weight: bold;
            padding: 0 4px;
        }
        .piutang-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: #ccc;
            color: white;
            font-weight: bold;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
        }
        .piutang-btn.active {
            background: #dc3545;
        }
        .piutang-btn:hover {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <!-- ==================== LOGIN OVERLAY ==================== -->
    <div id="login-overlay">
        <div class="login-container">
            <h2>POSPLUS</h2>
            <input type="text" id="login-username" placeholder="Username" autocomplete="off">
            <input type="password" id="login-password" placeholder="Password">
            <button id="login-btn">Masuk</button>
            <div id="login-error" class="error-message">Username atau password salah</div>
            <div class="hint">Hubungi administrator</div>
        </div>
    </div>

    <!-- ==================== HEADER ==================== -->
    <header class="app-header">
        <div class="header-content">
            <div class="app-title">
                <button class="drawer-toggle" id="drawer-toggle" onclick="toggleDrawer()">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <div class="icon-container">
                    <svg class="icon box-icon icon-primary" viewBox="0 0 24 24">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                        <line x1="12" y1="22.08" x2="12" y2="12"/>
                    </svg>
                </div>
                <span>POSPLUS</span>
            </div>
            <div class="header-actions">
                <button onclick="showSettingsModal()">
                    <svg class="icon settings-icon icon-primary" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                    Pengaturan
                </button>
            </div>
        </div>
    </header>

    <!-- ==================== DRAWER SIDEBAR (DENGAN SUBMENU) ==================== -->
    <div class="sidebar" id="sidebar">
        <!-- Grup MASTER DATA KASIR -->
        <div class="menu-group">
            <div class="menu-header" onclick="toggleSubMenu(this)">
                <span class="menu-title">MASTER DATA</span>
                <span class="arrow">></span>
            </div>
            <div class="sub-menu">
                <button onclick="openTambahItemKasirModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="16"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    <span>Tambah Item</span>
                </button>
                <button onclick="openDaftarItemKasirModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <line x1="9" y1="9" x2="15" y2="15"/>
                        <line x1="15" y1="9" x2="9" y2="15"/>
                    </svg>
                    <span>Daftar Item</span>
                </button>
                <button onclick="openTambahKategoriKasirModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="16"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    <span>Tambah Kategori</span>
                </button>
                <button onclick="openDaftarKategoriKasirModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
                        <path d="M10 2v20"/>
                    </svg>
                    <span>Daftar Kategori</span>
                </button>
                <button onclick="openTambahSatuanModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="16"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    <span>Tambah Satuan</span>
                </button>
                <button onclick="openDaftarSatuanModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <line x1="3" y1="9" x2="21" y2="9"/>
                        <line x1="9" y1="21" x2="9" y2="9"/>
                    </svg>
                    <span>Daftar Satuan</span>
                </button>
            </div>
        </div>

        <!-- Grup TRANSAKSI -->
        <div class="menu-group">
            <div class="menu-header" onclick="toggleSubMenu(this)">
                <span class="menu-title">TRANSAKSI</span>
                <span class="arrow">></span>
            </div>
            <div class="sub-menu">
                <button onclick="openTransaksiPage(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <rect x="2" y="5" width="20" height="14" rx="2" ry="2"/>
                        <line x1="2" y1="10" x2="22" y2="10"/>
                        <line x1="7" y1="15" x2="12" y2="15"/>
                    </svg>
                    <span>Transaksi Kasir</span>
                </button>
            </div>
        </div>

        <!-- Grup PELANGGAN & PEMASOK -->
        <div class="menu-group">
            <div class="menu-header" onclick="toggleSubMenu(this)">
                <span class="menu-title">CUST & SUPL</span>
                <span class="arrow">></span>
            </div>
            <div class="sub-menu">
                <button onclick="openTambahCustomerModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="8" r="4"/>
                        <path d="M5 20v-2a7 7 0 0 1 14 0v2"/>
                    </svg>
                    <span>Tambah Pelanggan</span>
                </button>
                <button onclick="openDaftarCustomerModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="8" r="4"/>
                        <path d="M5 20v-2a7 7 0 0 1 14 0v2"/>
                        <rect x="2" y="2" width="20" height="20" rx="2" ry="2" stroke="currentColor" fill="none"/>
                    </svg>
                    <span>Daftar Pelanggan</span>
                </button>
                <button onclick="openTambahSupplierModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <circle cx="12" cy="12" r="2"/>
                    </svg>
                    <span>Tambah Supplier</span>
                </button>
                <button onclick="openDaftarSupplierModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <circle cx="12" cy="12" r="2"/>
                        <rect x="2" y="2" width="20" height="20" rx="2" ry="2" stroke="currentColor" fill="none"/>
                    </svg>
                    <span>Daftar Supplier</span>
                </button>
            </div>
        </div>

        <!-- Grup INVENTORY -->
        <div class="menu-group">
            <div class="menu-header" onclick="toggleSubMenu(this)">
                <span class="menu-title">INVENTORY</span>
                <span class="arrow">></span>
            </div>
            <div class="sub-menu">
                <button onclick="openInventoryStokModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                        <line x1="12" y1="11" x2="12" y2="17"/>
                    </svg>
                    <span>Stok Barang</span>
                </button>
                <button onclick="openInventoryOpnameModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="12" y1="18" x2="12" y2="12"/>
                        <line x1="9" y1="15" x2="15" y2="15"/>
                    </svg>
                    <span>Stok Opname</span>
                </button>
                <button onclick="openInventoryLaporanModal(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    <span>Laporan Stok</span>
                </button>
            </div>
        </div>

        <!-- Grup LAPORAN -->
        <div class="menu-group">
            <div class="menu-header" onclick="toggleSubMenu(this)">
                <span class="menu-title">LAPORAN</span>
                <span class="arrow">></span>
            </div>
            <div class="sub-menu">
                <button onclick="openLaporanPage(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    <span>Laporan Penjualan</span>
                </button>
            </div>
        </div>

        <!-- Grup PEMBELIAN -->
        <div class="menu-group">
            <div class="menu-header" onclick="toggleSubMenu(this)">
                <span class="menu-title">PEMBELIAN</span>
                <span class="arrow">></span>
            </div>
            <div class="sub-menu">
                <button onclick="openPembelianPage(); closeSubMenu(this);">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"/>
                        <path d="M8 7h8M8 11h6M8 15h4"/>
                    </svg>
                    <span>Pembelian Barang</span>
                </button>
            </div>
        </div>
    </div>
    <div class="drawer-overlay" id="drawer-overlay" onclick="closeDrawer()"></div>

    <!-- ==================== AUDIO ELEMENTS ==================== -->
    <audio id="notification-success" class="audio-notification" preload="auto">
        <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=" type="audio/wav">
    </audio>
    <audio id="notification-warning" class="audio-notification" preload="auto">
        <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=" type="audio/wav">
    </audio>
    <audio id="notification-error" class="audio-notification" preload="auto">
        <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=" type="audio/wav">
    </audio>
    <audio id="button-click-sound" class="audio-notification" preload="auto">
        <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=" type="audio/wav">
    </audio>

    <!-- ==================== LOADING OVERLAY ==================== -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div style="margin-top: 20px; color: #006B54; font-weight: 600;">Memuat aplikasi...</div>
    </div>

    <!-- ==================== ERROR STATE ==================== -->
    <div id="error-state" class="error-state">
        <svg class="icon" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="12"/>
            <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        <h3>Gagal memuat aplikasi</h3>
        <p id="error-message"></p>
        <button class="retry-button" onclick="retryAppLoad()">
            <svg class="icon icon-sm" viewBox="0 0 24 24">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
            </svg>
            Coba Lagi
        </button>
    </div>

    <!-- ==================== MAIN CONTENT (BERANDA) ==================== -->
    <main class="main-content">
        <div class="placeholder-icon">
            <svg class="icon" viewBox="0 0 24 24" width="80" height="80">
                <rect x="2" y="5" width="20" height="14" rx="2" ry="2"/>
                <line x1="2" y1="10" x2="22" y2="10"/>
                <line x1="7" y1="15" x2="12" y2="15"/>
            </svg>
        </div>
        <h2>Selamat datang di POSPLUS</h2>
        <p>Gunakan menu di samping untuk memulai transaksi atau mengelola data.</p>
    </main>

    <!-- ==================== HALAMAN TRANSAKSI (PRODUK) ==================== -->
    <div id="transaksi-page">
        <div class="transaksi-header">
            <div class="transaksi-header-left">
                <button class="back-button" onclick="closeTransaksiPage()" title="Kembali ke Beranda">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                </button>
                <h2>Transaksi Kasir</h2>
            </div>
            <div class="transaksi-header-right">
                <div class="view-toggle">
                    <button id="view-list-btn" onclick="setProductViewMode('list')" title="Tampilan List">
                        <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none">
                            <line x1="8" y1="6" x2="21" y2="6"></line>
                            <line x1="8" y1="12" x2="21" y2="12"></line>
                            <line x1="8" y1="18" x2="21" y2="18"></line>
                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                        </svg>
                    </button>
                    <button id="view-grid-btn" onclick="setProductViewMode('grid')" title="Tampilan Grid">
                        <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none">
                            <rect x="3" y="3" width="7" height="7"></rect>
                            <rect x="14" y="3" width="7" height="7"></rect>
                            <rect x="3" y="14" width="7" height="7"></rect>
                            <rect x="14" y="14" width="7" height="7"></rect>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div style="display: flex; align-items: center; margin-bottom: 15px; gap: 10px; flex-wrap: wrap;">
            <input type="text" id="barcode-input" class="form-input" placeholder="Cari produk atau scan barcode..." oninput="filterProductList(this.value)" onkeypress="if(event.key==='Enter') processBarcode()" style="flex: 2; min-width: 200px;">
            <button id="customer-select-btn" class="action-btn" onclick="openSelectCustomerModal()" title="Pilih Pelanggan">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="8" r="4"/>
                    <path d="M5 20v-2a7 7 0 0 1 14 0v2"/>
                </svg>
                <span id="customer-badge" class="customer-badge" style="display: none;"></span>
            </button>
            <button id="cart-icon-btn" class="action-btn" onclick="openCartPage()" title="Lihat Keranjang">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/>
                    <circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                </svg>
                <span id="cart-count" class="cart-badge">0</span>
            </button>
        </div>
        <div id="product-container" style="max-height: 500px; overflow-y: auto; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 15px; padding: 10px;"></div>
    </div>

    <!-- ==================== HALAMAN CART ==================== -->
    <div id="cart-page">
        <div class="cart-header">
            <button class="back-button" onclick="closeCartPage()" title="Kembali ke Transaksi">
                <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
            </button>
            <h2>Keranjang Belanja</h2>
        </div>
        <div class="cart-content">
            <table class="cart-items-table">
                <thead>
                    <tr>
                        <th>Produk</th>
                        <th>Jumlah</th>
                        <th>Harga Satuan</th>
                        <th>Subtotal</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="cart-items-page"></tbody>
            </table>
            <div class="cart-total">
                Total: <span id="cart-total-page">Rp 0</span>
            </div>
            <div class="cart-actions">
                <button id="piutang-btn-cart" class="piutang-btn" onclick="addOutstandingToCart()">!</button>
                <button class="form-button-secondary" onclick="saveDraftTransaction()">Simpan Draft</button>
                <button class="form-button-primary" onclick="openPaymentPage()">Bayar</button>
            </div>
        </div>
    </div>

    <!-- ==================== HALAMAN PEMBAYARAN (MODIFIKASI) ==================== -->
    <div id="payment-page">
        <div class="payment-header">
            <button class="back-button" onclick="closePaymentPage()" title="Kembali ke Keranjang">
                <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
            </button>
            <h2>Pembayaran</h2>
        </div>
        <div class="payment-content">
            <div class="payment-summary">
                <div class="payment-summary-row">
                    <span>Total Belanja</span>
                    <span id="payment-total">Rp 0</span>
                </div>
                <div class="payment-summary-row total">
                    <span>Total Dibayar</span>
                    <span id="payment-grand-total">Rp 0</span>
                </div>
            </div>

            <!-- Grid metode pembayaran -->
            <div class="payment-methods-grid">
                <div class="payment-method-item">
                    <label>Tunai</label>
                    <input type="number" id="payment-cash" class="payment-input" min="0" step="0.01" value="0" oninput="updatePaymentSummary()">
                </div>
                <div class="payment-method-item">
                    <label>Kartu Debit/Kredit</label>
                    <input type="number" id="payment-card" class="payment-input" min="0" step="0.01" value="0" oninput="updatePaymentSummary()">
                </div>
                <div class="payment-method-item">
                    <label>Transfer Bank</label>
                    <input type="number" id="payment-transfer" class="payment-input" min="0" step="0.01" value="0" oninput="updatePaymentSummary()">
                </div>
                <div class="payment-method-item">
                    <label>E-Wallet</label>
                    <input type="number" id="payment-ewallet" class="payment-input" min="0" step="0.01" value="0" oninput="updatePaymentSummary()">
                </div>
            </div>

            <!-- Informasi kekurangan / kembalian -->
            <div id="shortage-display" style="display:none; color:red; margin-bottom:10px; padding:10px; background:#fff3f3; border-radius:10px;">
                Kurang bayar: Rp <span id="shortage-amount">0</span>
            </div>
            <div class="change-amount" id="change-amount">Kembalian: Rp 0</div>

            <div class="payment-actions">
                <button class="form-button-secondary" onclick="closePaymentPage()">Batal</button>
                <button class="form-button-primary" onclick="processPayment()">Proses Pembayaran</button>
            </div>

            <!-- Bagian printer -->
            <div class="printer-section">
                <button id="connect-printer-btn" class="form-button-secondary" onclick="togglePrinter()">
                    <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none">
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
                        <path d="M6 9V3h12v6"/>
                        <rect x="6" y="15" width="12" height="6" rx="2"/>
                    </svg>
                    <span id="connect-btn-text">Connect</span>
                </button>
                <div class="printer-status-indicator">
                    <span class="status-light" id="printer-status-light"></span>
                    <span id="printer-status-text"></span>
                </div>
                <button id="print-receipt-btn" class="form-button-primary" onclick="printReceipt()" disabled style="margin-left: auto;">
                    <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none">
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
                        <path d="M6 9V3h12v6"/>
                        <rect x="6" y="15" width="12" height="6" rx="2"/>
                    </svg>
                    Print Struk
                </button>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL KONFIRMASI PIUTANG ==================== -->
    <div class="modal-overlay" id="confirm-piutang-modal">
        <div class="modal-content" style="max-width:400px;">
            <div class="modal-header">
                <h2 class="modal-title">Konfirmasi Piutang</h2>
            </div>
            <div class="modal-body">
                <p>Jumlah bayar kurang sebesar <span id="shortage-confirm">Rp 0</span>.</p>
                <p>Apakah ingin melanjutkan transaksi dengan mencatat sisa sebagai piutang?</p>
                <p style="font-size:0.9rem; color:#666;">Pastikan pelanggan telah dipilih.</p>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px; margin-top:20px;">
                    <button class="form-button-secondary" onclick="closeConfirmPiutangModal()">Batal</button>
                    <button class="form-button-primary" onclick="processPaymentWithPiutang()">Ya, Lanjutkan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL PILIH CUSTOMER ==================== -->
    <div class="modal-overlay" id="select-customer-modal">
        <div class="modal-content" style="max-width:500px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <circle cx="12" cy="8" r="4"/>
                        <path d="M5 20v-2a7 7 0 0 1 14 0v2"/>
                    </svg>
                    Pilih Pelanggan
                </h2>
            </div>
            <div class="modal-body">
                <div id="select-customer-list" style="max-height:400px; overflow-y:auto;"></div>
                <div style="margin-top:20px;">
                    <button type="button" class="form-button-secondary" style="width:100%;" onclick="closeSelectCustomerModal()">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL TAMBAH KATEGORI KASIR ==================== -->
    <div class="modal-overlay" id="kasir-category-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="kasir-category-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="16"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    Tambah Kategori Kasir
                </h2>
            </div>
            <div class="modal-body">
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Nama Kategori</label>
                    <input type="text" class="form-input" id="kasir-category-name" placeholder="">
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                    <button type="button" class="form-button-secondary" onclick="closeKasirCategoryModal()">BATAL</button>
                    <button type="button" class="form-button-primary" onclick="saveKasirCategory()">SIMPAN</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL TAMBAH ITEM KASIR ==================== -->
    <div class="modal-overlay" id="kasir-item-modal">
        <div class="modal-content" style="max-width:600px;">
            <div class="modal-header">
                <h2 class="modal-title" id="kasir-item-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="16"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    Tambah Item Kasir
                </h2>
            </div>
            <div class="modal-body" style="max-height:70vh;">
                <form id="kasir-item-form" onsubmit="event.preventDefault();">
                    <!-- Nama Item -->
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Nama Item</label>
                        <input type="text" class="form-input" id="kasir-item-name" placeholder="" required>
                    </div>
                    <!-- Kode Item -->
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Kode Item</label>
                        <input type="text" class="form-input" id="kasir-item-code" placeholder="" required>
                        <small style="color:#666; display:block; margin-top:4px;">Kode untuk barcode timbangan (produk ditimbang)</small>
                    </div>
                    <!-- Barcode Item -->
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Barcode Item</label>
                        <input type="text" class="form-input" id="kasir-item-barcode" placeholder="">
                        <small style="color:#666; display:block; margin-top:4px;">Barcode untuk produk kemasan (jika berbeda dengan kode)</small>
                    </div>
                    <!-- Kategori Kasir -->
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Kategori Kasir</label>
                        <select class="form-input" id="kasir-item-category">
                            <option value="">-- Pilih Kategori --</option>
                        </select>
                    </div>
                    <!-- Harga Dasar dan Harga Jual -->
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
                        <div>
                            <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Harga Dasar</label>
                            <input type="number" class="form-input" id="kasir-item-harga-dasar" min="0" value="">
                        </div>
                        <div>
                            <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Harga Jual</label>
                            <input type="number" class="form-input" id="kasir-item-harga-jual" min="0" value="" step="0.01">
                        </div>
                    </div>
                    <!-- Berat dan Satuan -->
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
                        <div>
                            <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Berat</label>
                            <input type="number" class="form-input" id="kasir-item-berat" min="0" value="" step="0.01">
                        </div>
                        <div>
                            <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Satuan</label>
                            <select class="form-input" id="kasir-item-satuan">
                                <option value="">-- Pilih Satuan --</option>
                            </select>
                        </div>
                    </div>
                    <!-- Diskon Opsional -->
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Diskon (%) *opsional</label>
                        <input type="number" class="form-input" id="kasir-item-diskon" min="0" max="100" value="" step="0.1">
                    </div>
                    <!-- Stok Awal -->
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Stok Awal</label>
                        <input type="number" class="form-input" id="kasir-item-stock" min="0" value="0" step="any">
                    </div>
                    <!-- Produk Timbangan? -->
                    <div style="margin-bottom:15px;">
                        <label>
                            <input type="checkbox" id="kasir-item-weighable"> Produk Timbangan (harga per kg)
                        </label>
                    </div>

                    <!-- ==================== BAGIAN KONVERSI SATUAN ==================== -->
                    <div class="conversions-section">
                        <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Konversi Satuan</label>
                        <button type="button" id="add-conversion-btn" onclick="showConversionForm()">
                            <svg class="icon" viewBox="0 0 24 24" width="20" height="20">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="12" y1="8" x2="12" y2="16"/>
                                <line x1="8" y1="12" x2="16" y2="12"/>
                            </svg>
                            Tambah Konversi Satuan
                        </button>
                        
                        <!-- Container untuk form tambah/edit konversi -->
                        <div id="conversion-form-container">
                            <div id="conversion-form">
                                <div class="form-row">
                                    <label>Satuan</label>
                                    <select id="conv-unit" class="form-input">
                                        <option value="">-- Pilih Satuan --</option>
                                    </select>
                                </div>
                                <div class="form-row">
                                    <label>Nilai Satuan (berapa unit dasar per satuan ini)</label>
                                    <input type="number" id="conv-value" class="form-input" placeholder="" min="0.01" step="0.01">
                                </div>
                                <div class="form-row">
                                    <label>Barcode Satuan</label>
                                    <input type="text" id="conv-barcode" class="form-input" placeholder="" required>
                                </div>
                                <div class="form-row">
                                    <label>SKU (Opsional)</label>
                                    <input type="text" id="conv-sku" class="form-input" placeholder="">
                                </div>
                                <div class="form-row">
                                    <label>Harga Dasar</label>
                                    <input type="number" id="conv-base-price" class="form-input" min="0" value="">
                                </div>
                                <div class="form-row">
                                    <label>Harga Jual</label>
                                    <input type="number" id="conv-sell-price" class="form-input" min="0" value="">
                                </div>
                                <div class="form-row">
                                    <label>Poin Pelanggan (Opsional)</label>
                                    <input type="number" id="conv-points" class="form-input" min="0" value="">
                                </div>
                                <div class="form-row">
                                    <label>Komisi Sales (Opsional)</label>
                                    <input type="number" id="conv-commission" class="form-input" min="0" value="">
                                </div>
                                <div class="form-buttons">
                                    <button type="button" class="form-button-secondary" onclick="hideConversionForm()">Batal</button>
                                    <button type="button" class="form-button-primary" onclick="saveConversion()">Selesai</button>
                                </div>
                            </div>
                        </div>

                        <!-- Daftar konversi yang sudah ditambahkan -->
                        <div id="conversions-list" class="conversions-list">
                            <!-- Akan diisi oleh JavaScript -->
                        </div>
                    </div>

                    <!-- Level Harga (Qty Break Pricing) -->
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Level Harga (Qty Break)</label>
                        <div class="level-harga-container" id="level-harga-container">
                            <!-- Level akan diisi javascript -->
                        </div>
                        <div id="level-error" style="color:#dc3545; font-size:0.85rem; margin-top:5px; display:none;"></div>
                        <button type="button" class="btn-add-level" onclick="addLevelRow(0,0)">
                            <svg class="icon icon-sm" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
                            Tambah Level
                        </button>
                    </div>

                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                        <button type="button" class="form-button-secondary" onclick="closeKasirItemModal()">BATAL</button>
                        <button type="button" class="form-button-primary" onclick="saveKasirItem()">SIMPAN</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL DAFTAR KATEGORI KASIR ==================== -->
    <div class="modal-overlay" id="list-kasir-category-modal">
        <div class="modal-content" style="max-width:500px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
                        <path d="M10 2v20"/>
                    </svg>
                    Daftar Kategori Kasir
                </h2>
            </div>
            <div class="modal-body">
                <div id="kasir-category-list-container" style="max-height:400px; overflow-y:auto;"></div>
                <div style="margin-top:20px;">
                    <button type="button" class="form-button-secondary" style="width:100%;" onclick="closeListKasirCategoryModal()">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL DAFTAR ITEM KASIR ==================== -->
    <div class="modal-overlay" id="list-kasir-item-modal">
        <div class="modal-content" style="max-width:700px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <line x1="9" y1="9" x2="15" y2="15"/>
                        <line x1="15" y1="9" x2="9" y2="15"/>
                    </svg>
                    Daftar Item Kasir
                </h2>
            </div>
            <div class="modal-body">
                <div id="kasir-item-list-container" style="max-height:400px; overflow-y:auto;"></div>
                <div style="margin-top:20px;">
                    <button type="button" class="form-button-secondary" style="width:100%;" onclick="closeListKasirItemModal()">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL SATUAN (DAFTAR) ==================== -->
    <div class="modal-overlay" id="list-satuan-modal">
        <div class="modal-content" style="max-width:500px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <line x1="3" y1="9" x2="21" y2="9"/>
                        <line x1="9" y1="21" x2="9" y2="9"/>
                    </svg>
                    Daftar Satuan
                </h2>
            </div>
            <div class="modal-body">
                <div id="satuan-list-container" style="max-height:400px; overflow-y:auto;"></div>
                <div style="margin-top:20px;">
                    <button type="button" class="form-button-secondary" style="width:100%;" onclick="closeListSatuanModal()">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL TAMBAH SATUAN ==================== -->
    <div class="modal-overlay" id="satuan-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="satuan-modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="16"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    Tambah Satuan
                </h2>
            </div>
            <div class="modal-body">
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Nama Satuan</label>
                    <input type="text" class="form-input" id="satuan-name" placeholder="">
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                    <button type="button" class="form-button-secondary" onclick="closeSatuanModal()">BATAL</button>
                    <button type="button" class="form-button-primary" onclick="saveSatuan()">SIMPAN</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL CUSTOMER (TAMBAH/EDIT) DENGAN FIELD BARU ==================== -->
    <div class="modal-overlay" id="customer-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="customer-modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <circle cx="12" cy="8" r="4"/>
                        <path d="M5 20v-2a7 7 0 0 1 14 0v2"/>
                    </svg>
                    Tambah Pelanggan
                </h2>
            </div>
            <div class="modal-body">
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Nama</label>
                    <input type="text" class="form-input" id="customer-name" placeholder="" required>
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Kode Pelanggan</label>
                    <input type="text" class="form-input" id="customer-code" placeholder="Misal: CUST-001">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Tingkatan</label>
                    <select class="form-input" id="customer-tier">
                        <option value="Bronze">Bronze</option>
                        <option value="Silver">Silver</option>
                        <option value="Gold">Gold</option>
                        <option value="Platinum">Platinum</option>
                    </select>
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Nomor Rekening</label>
                    <input type="text" class="form-input" id="customer-account" placeholder="Nomor rekening">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Nama Bank</label>
                    <input type="text" class="form-input" id="customer-bank" placeholder="Nama Bank">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Token Listrik</label>
                    <input type="text" class="form-input" id="customer-token" placeholder="ID pelanggan listrik">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Email</label>
                    <input type="email" class="form-input" id="customer-email" placeholder="contoh@email.com">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Telepon</label>
                    <input type="text" class="form-input" id="customer-phone" placeholder="">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Alamat</label>
                    <textarea class="form-input" id="customer-address" rows="3"></textarea>
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Piutang (Outstanding)</label>
                    <input type="number" class="form-input" id="customer-outstanding" min="0" step="0.01" value="0">
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                    <button type="button" class="form-button-secondary" onclick="closeCustomerModal()">BATAL</button>
                    <button type="button" class="form-button-primary" onclick="saveCustomer()">SIMPAN</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL DAFTAR CUSTOMER ==================== -->
    <div class="modal-overlay" id="list-customer-modal">
        <div class="modal-content" style="max-width:600px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <circle cx="12" cy="8" r="4"/>
                        <path d="M5 20v-2a7 7 0 0 1 14 0v2"/>
                        <rect x="2" y="2" width="20" height="20" rx="2" ry="2" stroke="currentColor" fill="none"/>
                    </svg>
                    Daftar Pelanggan
                </h2>
            </div>
            <div class="modal-body">
                <div id="customer-list-container" style="max-height:400px; overflow-y:auto;"></div>
                <div style="margin-top:20px;">
                    <button type="button" class="form-button-secondary" style="width:100%;" onclick="closeListCustomerModal()">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL SUPPLIER (TAMBAH/EDIT) DENGAN FIELD BARU ==================== -->
    <div class="modal-overlay" id="supplier-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="supplier-modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <circle cx="12" cy="12" r="2"/>
                    </svg>
                    Tambah Supplier
                </h2>
            </div>
            <div class="modal-body">
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Nama</label>
                    <input type="text" class="form-input" id="supplier-name" placeholder="" required>
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Kode Supplier</label>
                    <input type="text" class="form-input" id="supplier-code" placeholder="Misal: SUP-001">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Nomor Rekening</label>
                    <input type="text" class="form-input" id="supplier-account" placeholder="Nomor rekening">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Email</label>
                    <input type="email" class="form-input" id="supplier-email" placeholder="contoh@email.com">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Telepon</label>
                    <input type="text" class="form-input" id="supplier-phone" placeholder="">
                </div>
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Alamat</label>
                    <textarea class="form-input" id="supplier-address" rows="3"></textarea>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                    <button type="button" class="form-button-secondary" onclick="closeSupplierModal()">BATAL</button>
                    <button type="button" class="form-button-primary" onclick="saveSupplier()">SIMPAN</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL DAFTAR SUPPLIER ==================== -->
    <div class="modal-overlay" id="list-supplier-modal">
        <div class="modal-content" style="max-width:600px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <circle cx="12" cy="12" r="2"/>
                        <rect x="2" y="2" width="20" height="20" rx="2" ry="2" stroke="currentColor" fill="none"/>
                    </svg>
                    Daftar Supplier
                </h2>
            </div>
            <div class="modal-body">
                <div id="supplier-list-container" style="max-height:400px; overflow-y:auto;"></div>
                <div style="margin-top:20px;">
                    <button type="button" class="form-button-secondary" style="width:100%;" onclick="closeListSupplierModal()">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL INPUT KODE PENDING (BARU) ==================== -->
    <div class="modal-overlay" id="pending-code-modal">
        <div class="modal-content" style="max-width:400px;">
            <div class="modal-header">
                <h2 class="modal-title">Simpan Draft Transaksi</h2>
            </div>
            <div class="modal-body">
                <div style="margin-bottom:15px;">
                    <label style="display:block; margin-bottom:8px; color:#333; font-weight:500;">Kode / Nama Pending</label>
                    <input type="text" id="pending-code-input" class="form-input" placeholder="Misal: PENDING-001" autocomplete="off">
                    <small style="color:#666;">Kosongkan untuk menggunakan nama default</small>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                    <button type="button" class="form-button-secondary" onclick="closePendingCodeModal()">Batal</button>
                    <button type="button" class="form-button-primary" onclick="confirmSaveDraft()">Simpan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== SETTINGS MODAL ==================== -->
    <div class="modal-overlay" id="settings-modal">
        <div class="modal-content" style="max-width:500px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <svg class="icon icon-primary settings-icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                    Pengaturan
                </h2>
            </div>
            <div class="modal-body">
                <div id="settings-content">
                    <!-- Konten settings diisi oleh JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL INVENTORY ==================== -->
    <div class="modal-overlay" id="inventory-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="inventory-modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                    </svg>
                    Inventory
                </h2>
            </div>
            <div class="modal-body" id="inventory-modal-body">
            </div>
        </div>
    </div>

    <!-- ==================== TOMBOL FLOATING UNTUK PENDING DENGAN BADGE ==================== -->
    <button id="pending-transactions-btn" class="floating-btn" onclick="openPendingTransactionsModal()" title="Transaksi Pending">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
        </svg>
        <span id="pending-badge" class="pending-badge" style="display: none;">0</span>
    </button>

    <!-- ==================== MODAL PENDING TRANSACTIONS ==================== -->
    <div class="modal-overlay" id="pending-transactions-modal">
        <div class="modal-content" style="max-width:600px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <svg class="icon icon-primary" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    Transaksi Pending
                </h2>
            </div>
            <div class="modal-body">
                <div id="pending-transactions-list" style="max-height:400px; overflow-y:auto;"></div>
                <div style="margin-top:20px; display:grid;grid-template-columns:1fr;gap:10px;">
                    <button type="button" class="form-button-secondary" onclick="closePendingTransactionsModal()">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== NOTIFICATION ==================== -->
    <div id="notification"></div>
    
    <script>
      // Konfigurasi milikmu
      const firebaseConfig = {
        apiKey: "AIzaSyCVB9V4jLWRFrsVLBnnL4-0wGCshtvozUY",
        authDomain: "posplus-32429.firebaseapp.com",
        projectId: "posplus-32429",
        storageBucket: "posplus-32429.firebasestorage.app",
        messagingSenderId: "5210906695",
        appId: "1:5210906695:web:7a59f0f83c3bf06ac11162"
      };
    
      // Inisialisasi Firebase
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
    </script>
    
    <script src="app.js"></script>
    <!-- File JavaScript eksternal sudah dipanggil di head -->
</body>
</html>
